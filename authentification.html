<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/authentification.css">
    <title>flourish.com</title>
</head>
<!-- to connect to an acc use for example email: "jean@test.com",
                        password: "password123" -->
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="logo">
            <h1>Flourish</h1>
        </div>
    </nav>

    <!-- Header -->
    <div class="header">
        <h2>Welcome to Flourish</h2>
        <p>Are you ready to level up your daily habits?</p>
    </div>

    <!-- Container d'authentification -->
    <div class="auth-container">
        <div class="auth-box">
            <!-- Onglets -->
            <div class="auth-tabs">
                <div class="tab active" onclick="switchTab('login')">Se connecter</div>
                <div class="tab" onclick="switchTab('signup')">S'inscrire</div>
            </div>

            <!-- Contenu des formulaires -->
            <div class="form-content">
                <!-- Formulaire de connexion -->
                <div class="form-section active" id="login-form">
                    <h3 style="margin-bottom: 30px; color: #333; font-size: 1.5em;">Connexion</h3>
                    
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" placeholder="votre@email.com" required>
                        <div class="error-message" id="login-email-error">Veuillez entrer un email valide</div>
                    </div>

                    <div class="form-group">
                        <label for="login-password">Mot de passe</label>
                        <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <div class="error-message" id="login-password-error">Le mot de passe est requis</div>
                    </div>

                    <button class="btn-submit" onclick="handleLogin()">Se connecter</button>

                    <div class="form-footer">
                        <a href="#" onclick="alert('Fonctionnalit√© √† venir'); return false;">Mot de passe oubli√©?</a>
                    </div>
                </div>

                <!-- Formulaire d'inscription -->
                <div class="form-section" id="signup-form">
                    <h3 style="margin-bottom: 30px; color: #333; font-size: 1.5em;">Cr√©er un compte</h3>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="signup-firstname">Pr√©nom</label>
                            <input type="text" id="signup-firstname" placeholder="Jean" required>
                            <div class="error-message" id="signup-firstname-error">Le pr√©nom est requis</div>
                        </div>

                        <div class="form-group">
                            <label for="signup-lastname">Nom</label>
                            <input type="text" id="signup-lastname" placeholder="Dupont" required>
                            <div class="error-message" id="signup-lastname-error">Le nom est requis</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="signup-age">√Çge</label>
                        <input type="number" id="signup-age" placeholder="18" min="13" max="120" required>
                        <div class="error-message" id="signup-age-error">Vous devez avoir au moins 13 ans</div>
                    </div>

                    <div class="form-group">
                        <label for="signup-email">Email</label>
                        <input type="email" id="signup-email" placeholder="votre@email.com" required>
                        <div class="error-message" id="signup-email-error">Veuillez entrer un email valide</div>
                    </div>

                    <div class="form-group">
                        <label for="signup-password">Mot de passe</label>
                        <input type="password" id="signup-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                        <div class="password-strength">
                            <div class="password-strength-bar"></div>
                        </div>
                        <div class="password-strength-text"></div>
                        <div class="error-message" id="signup-password-error">Le mot de passe doit contenir au moins 8 caract√®res</div>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="terms" required>
                        <label for="terms">
                            J'accepte les <a href="#" onclick="showTerms(); return false;">conditions d'utilisation</a> 
                            et la <a href="#" onclick="showPrivacy(); return false;">politique de confidentialit√©</a>
                        </label>
                    </div>

                    <button class="btn-submit" onclick="handleSignup()">Cr√©er mon compte</button>

                    <div class="form-footer">
                        Vous avez d√©j√† un compte? <a href="#" onclick="switchTab('login'); return false;">Se connecter</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Zone de notification -->
    <div class="notification" id="notification">
        <div class="notification-title" id="notification-title"></div>
        <div class="notification-message" id="notification-message"></div>
    </div>

    <script>
        // Base de donn√©es simul√©e (localStorage)
        function getUsers() {
            const users = localStorage.getItem('flourish_users');
            return users ? JSON.parse(users) : [];
        }

        function saveUsers(users) {
            localStorage.setItem('flourish_users', JSON.stringify(users));
        }

        // Initialiser avec des utilisateurs de test (OPTIONNEL - pour d√©mo)
        function initializeTestUsers() {
            const users = getUsers();
            
            // Si aucun utilisateur n'existe, cr√©er des comptes de test
            if (users.length === 0) {
                const testUsers = [
                    {
                        id: 1,
                        firstname: "Jean",
                        lastname: "Dupont",
                        age: 22,
                        email: "jean@test.com",
                        password: "password123",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        firstname: "Marie",
                        lastname: "Martin",
                        age: 20,
                        email: "marie@test.com",
                        password: "password123",
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        firstname: "Admin",
                        lastname: "User",
                        age: 25,
                        email: "admin@flourish.com",
                        password: "admin123",
                        createdAt: new Date().toISOString()
                    }
                ];
                
                saveUsers(testUsers);
                console.log("‚úÖ Utilisateurs de test cr√©√©s:");
                console.log("üìß jean@test.com / password123");
                console.log("üìß marie@test.com / password123");
                console.log("üìß admin@flourish.com / admin123");
            }
        }

        // Appeler au chargement de la page
        window.addEventListener('DOMContentLoaded', function() {
            initializeTestUsers();
        });

        function saveCurrentUser(user) {
            localStorage.setItem('flourish_current_user', JSON.stringify(user));
        }

        // Basculer entre les onglets
        function switchTab(tab) {
            // Mettre √† jour les onglets
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            // Mettre √† jour le contenu
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
            });

            if (tab === 'login') {
                document.getElementById('login-form').classList.add('active');
            } else {
                document.getElementById('signup-form').classList.add('active');
            }

            // R√©initialiser les erreurs
            clearErrors();
        }

        // Validation email
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // Force du mot de passe
        document.getElementById('signup-password')?.addEventListener('input', function(e) {
            const password = e.target.value;
            const strengthBar = document.querySelector('.password-strength-bar');
            const strengthText = document.querySelector('.password-strength-text');
            const strengthContainer = document.querySelector('.password-strength');

            if (password.length === 0) {
                strengthContainer.classList.remove('show');
                strengthText.classList.remove('show');
                return;
            }

            strengthContainer.classList.add('show');
            strengthText.classList.add('show');

            let strength = 0;
            if (password.length >= 8) strength++;
            if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^a-zA-Z0-9]/.test(password)) strength++;

            strengthBar.className = 'password-strength-bar';
            if (strength <= 1) {
                strengthBar.classList.add('weak');
                strengthText.textContent = '‚ö†Ô∏è Faible - Ajoutez des chiffres et majuscules';
                strengthText.style.color = '#e53e3e';
            } else if (strength <= 2) {
                strengthBar.classList.add('medium');
                strengthText.textContent = '‚ö° Moyen - Ajoutez des caract√®res sp√©ciaux';
                strengthText.style.color = '#ed8936';
            } else {
                strengthBar.classList.add('strong');
                strengthText.textContent = '‚úÖ Fort - Excellent mot de passe!';
                strengthText.style.color = '#48bb78';
            }
        });

        // G√©rer la connexion
        function handleLogin() {
            clearErrors();

            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;

            let hasError = false;

            // Validation email
            if (!email || !isValidEmail(email)) {
                showError('login-email', 'login-email-error');
                hasError = true;
            }

            // Validation mot de passe
            if (!password) {
                showError('login-password', 'login-password-error');
                hasError = true;
            }

            if (hasError) return;

            // V√©rifier les identifiants
            const users = getUsers();
            const user = users.find(u => u.email === email && u.password === password);

            if (user) {
                saveCurrentUser(user);
                showNotification('Connexion r√©ussie!', `Bienvenue ${user.firstname}! Redirection...`, 'success');
                setTimeout(() => {
                    window.location.href = 'accueil.html'; // Rediriger vers l'application
                }, 1500);
            } else {
                showNotification('Erreur de connexion', 'Email ou mot de passe incorrect', 'error');
            }
        }

        // G√©rer l'inscription
        function handleSignup() {
            clearErrors();

            const firstname = document.getElementById('signup-firstname').value.trim();
            const lastname = document.getElementById('signup-lastname').value.trim();
            const age = parseInt(document.getElementById('signup-age').value);
            const email = document.getElementById('signup-email').value.trim();
            const password = document.getElementById('signup-password').value;
            const termsAccepted = document.getElementById('terms').checked;

            let hasError = false;

            // Validation pr√©nom
            if (!firstname) {
                showError('signup-firstname', 'signup-firstname-error');
                hasError = true;
            }

            // Validation nom
            if (!lastname) {
                showError('signup-lastname', 'signup-lastname-error');
                hasError = true;
            }

            // Validation √¢ge
            if (!age || age < 13) {
                showError('signup-age', 'signup-age-error');
                hasError = true;
            }

            // Validation email
            if (!email || !isValidEmail(email)) {
                showError('signup-email', 'signup-email-error');
                hasError = true;
            }

            // Validation mot de passe
            if (!password || password.length < 8) {
                showError('signup-password', 'signup-password-error');
                hasError = true;
            }

            // Validation conditions
            if (!termsAccepted) {
                showNotification('Conditions requises', 'Veuillez accepter les conditions d\'utilisation', 'error');
                hasError = true;
            }

            if (hasError) return;

            // V√©rifier si l'email existe d√©j√†
            const users = getUsers();
            if (users.some(u => u.email === email)) {
                showError('signup-email', 'signup-email-error');
                document.getElementById('signup-email-error').textContent = 'Cet email est d√©j√† utilis√©';
                document.getElementById('signup-email-error').classList.add('show');
                showNotification('Email d√©j√† utilis√©', 'Cet email est d√©j√† associ√© √† un compte', 'error');
                return;
            }

            // Cr√©er le nouvel utilisateur
            const newUser = {
                id: Date.now(),
                firstname,
                lastname,
                age,
                email,
                password,
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            saveUsers(users);
            saveCurrentUser(newUser);

            showNotification('Compte cr√©√©!', `Bienvenue ${firstname}! Votre compte a √©t√© cr√©√© avec succ√®s.`, 'success');
            
            setTimeout(() => {
                window.location.href = 'accueil.html'; // Rediriger vers l'application
            }, 1500);
        }

        // Afficher une erreur
        function showError(inputId, errorId) {
            document.getElementById(inputId).classList.add('error');
            document.getElementById(errorId).classList.add('show');
        }

        // Effacer toutes les erreurs
        function clearErrors() {
            document.querySelectorAll('input').forEach(input => {
                input.classList.remove('error');
            });
            document.querySelectorAll('.error-message').forEach(error => {
                error.classList.remove('show');
            });
        }

        // Afficher une notification
        function showNotification(title, message, type) {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notification-title');
            const notificationMessage = document.getElementById('notification-message');

            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            notification.className = `notification show ${type}`;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Afficher les conditions
        function showTerms() {
            alert('Conditions d\'utilisation:\n\n1. Vous devez avoir au moins 13 ans pour utiliser ce service.\n2. Vous √™tes responsable de la confidentialit√© de votre compte.\n3. L\'utilisation doit √™tre conforme aux lois en vigueur.\n4. Nous nous r√©servons le droit de suspendre tout compte en cas d\'abus.\n\nPour la version compl√®te, consultez notre site web.');
        }

        // Afficher la politique de confidentialit√©
        function showPrivacy() {
            alert('Politique de confidentialit√©:\n\n1. Vos donn√©es personnelles sont stock√©es de mani√®re s√©curis√©e.\n2. Nous ne partageons pas vos informations avec des tiers.\n3. Vous pouvez demander la suppression de vos donn√©es √† tout moment.\n4. Les cookies sont utilis√©s pour am√©liorer votre exp√©rience.\n\nPour la version compl√®te, consultez notre site web.');
        }

        // Permettre la soumission avec Enter
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const loginForm = document.getElementById('login-form');
                const signupForm = document.getElementById('signup-form');
                
                if (loginForm.classList.contains('active')) {
                    handleLogin();
                } else if (signupForm.classList.contains('active')) {
                    handleSignup();
                }
            }
        });
    </script>
</body>
</html>